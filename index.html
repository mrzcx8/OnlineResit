<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resit Generator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .container {
            background-color: #fff;
            padding: 20px;
            border: 1px solid #ccc;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            width: 80%;
            max-width: 800px;
        }

        h1 {
            text-align: center;
            color: #333;
        }

        .input-section {
            margin-bottom: 20px;
        }

        .input-section label {
            display: block;
            margin: 10px 0 5px;
            font-weight: bold;
        }

        .input-section input, .input-section select {
            width: 100%;
            padding: 8px;
            box-sizing: border-box;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        .input-section button {
            margin-top: 10px;
            padding: 10px 20px;
            background-color: #28a745;
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .input-section button:hover {
            background-color: #218838;
        }

        .receipt {
            margin-top: 20px;
            padding: 20px;
            border: 1px solid #ccc;
            background-color: #f9f9f9;
            display: none; /* Sembunyikan resit sampai data diisi */
        }

        .receipt h2 {
            text-align: center;
            margin-bottom: 20px;
        }

        .receipt p {
            margin: 5px 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        table th, table td {
            border: 1px solid #ccc;
            padding: 8px;
            text-align: center;
        }

        table th {
            background-color: #f4f4f4;
        }

        .total {
            text-align: right;
            font-size: 18px;
            font-weight: bold;
        }

        footer {
            text-align: center;
            margin-top: 20px;
            font-style: italic;
            color: #555;
        }

        @media print {
            .input-section, button {
                display: none; /* Sembunyikan input dan butang ketika mencetak */
            }
            .receipt {
                border: none;
                box-shadow: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Resit Generator</h1>

        <!-- Input Section -->
        <div class="input-section">
            <label for="customerName">Nama Pelanggan:</label>
            <input type="text" id="customerName" placeholder="Masukkan nama pelanggan">

            <label for="customerPhone">No. Telefon:</label>
            <input type="text" id="customerPhone" placeholder="Masukkan no. telefon">

            <label for="currency">Mata Wang:</label>
            <select id="currency">
                <option value="RM">RM (Ringgit Malaysia)</option>
                <option value="USD">USD (Dollar Amerika)</option>
                <option value="SGD">SGD (Dollar Singapura)</option>
            </select>

            <label for="discount">Diskaun (%):</label>
            <input type="number" id="discount" placeholder="Masukkan diskaun">

            <label for="tax">Cukai (%):</label>
            <input type="number" id="tax" placeholder="Masukkan cukai">

            <label for="itemName">Nama Barang:</label>
            <input type="text" id="itemName" placeholder="Masukkan nama barang">

            <label for="itemQuantity">Kuantiti:</label>
            <input type="number" id="itemQuantity" placeholder="Masukkan kuantiti">

            <label for="itemPrice">Harga Seunit:</label>
            <input type="number" id="itemPrice" placeholder="Masukkan harga seunit">

            <button onclick="addItem()">Tambah Barang</button>
            <button onclick="generateReceipt()">Jana Resit</button>
            <button onclick="printReceipt()">Cetak Resit</button>
            <button onclick="saveAsPDF()">Simpan sebagai PDF</button>
        </div>

        <!-- Receipt Section -->
        <div class="receipt" id="receipt">
            <h2>Resit Jualan</h2>
            <p>No. Resit: <span id="receiptNumber"></span></p>
            <p>Tarikh: <span id="receiptDate"></span></p>

            <section class="customer-info">
                <h3>Maklumat Pelanggan</h3>
                <p>Nama: <span id="displayCustomerName"></span></p>
                <p>No. Telefon: <span id="displayCustomerPhone"></span></p>
            </section>

            <section class="items">
                <h3>Senarai Barang</h3>
                <table id="itemsTable">
                    <thead>
                        <tr>
                            <th>Bil</th>
                            <th>Nama Barang</th>
                            <th>Kuantiti</th>
                            <th>Harga Seunit</th>
                            <th>Jumlah</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Baris barang akan ditambahkan di sini -->
                    </tbody>
                </table>
            </section>

            <section class="total">
                <h3>Jumlah Keseluruhan</h3>
                <p>Diskaun: <span id="displayDiscount">0</span>%</p>
                <p>Cukai: <span id="displayTax">0</span>%</p>
                <p>Jumlah: <span id="currencyDisplay"></span> <span id="totalAmount">0.00</span></p>
            </section>

            <footer>
                <p>Terima kasih kerana berurusan dengan kami!</p>
            </footer>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
        let items = [];
        let totalAmount = 0;

        // Fungsi untuk menambah barang
        function addItem() {
            const itemName = document.getElementById('itemName').value;
            const itemQuantity = parseInt(document.getElementById('itemQuantity').value);
            const itemPrice = parseFloat(document.getElementById('itemPrice').value);

            if (itemName && itemQuantity && itemPrice) {
                const itemTotal = itemQuantity * itemPrice;
                items.push({ itemName, itemQuantity, itemPrice, itemTotal });
                totalAmount += itemTotal;

                // Reset input fields
                document.getElementById('itemName').value = '';
                document.getElementById('itemQuantity').value = '';
                document.getElementById('itemPrice').value = '';

                alert('Barang berjaya ditambah!');
            } else {
                alert('Sila isi semua maklumat barang.');
            }
        }

        // Fungsi untuk menjana resit
        function generateReceipt() {
            const customerName = document.getElementById('customerName').value;
            const customerPhone = document.getElementById('customerPhone').value;
            const discount = parseFloat(document.getElementById('discount').value) || 0;
            const tax = parseFloat(document.getElementById('tax').value) || 0;
            const currency = document.getElementById('currency').value;

            if (!customerName || !customerPhone || items.length === 0) {
                alert('Sila isi maklumat pelanggan dan tambah sekurang-kurangnya satu barang.');
                return;
            }

            // Paparkan maklumat pelanggan
            document.getElementById('displayCustomerName').textContent = customerName;
            document.getElementById('displayCustomerPhone').textContent = customerPhone;

            // Paparkan tarikh
            const currentDate = new Date().toLocaleDateString();
            document.getElementById('receiptDate').textContent = currentDate;

            // Paparkan mata wang
            document.getElementById('currencyDisplay').textContent = currency;

            // Paparkan barang
            const itemsTable = document.getElementById('itemsTable').getElementsByTagName('tbody')[0];
            itemsTable.innerHTML = ''; // Kosongkan jadual sebelum menambah barang baru
            items.forEach((item, index) => {
                const row = itemsTable.insertRow();
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${item.itemName}</td>
                    <td>${item.itemQuantity}</td>
                    <td>${currency} ${item.itemPrice.toFixed(2)}</td>
                    <td>${currency} ${item.itemTotal.toFixed(2)}</td>
                `;
            });

            // Kira jumlah keseluruhan dengan diskaun dan cukai
            const discountedAmount = totalAmount * (1 - discount / 100);
            const taxAmount = discountedAmount * (tax / 100);
            const totalWithTax = discountedAmount + taxAmount;

            // Paparkan diskaun, cukai, dan jumlah keseluruhan
            document.getElementById('displayDiscount').textContent = discount;
            document.getElementById('displayTax').textContent = tax;
            document.getElementById('totalAmount').textContent = totalWithTax.toFixed(2);

            // Tunjukkan resit
            document.getElementById('receipt').style.display = 'block';

            // Auto-nombor resit
            document.getElementById('receiptNumber').textContent = generateReceiptNumber();
        }

        // Fungsi untuk mencetak resit
        function printReceipt() {
            window.print();
        }

        // Fungsi untuk menyimpan resit sebagai PDF
        function saveAsPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            const receiptContent = document.getElementById('receipt').innerText;
            doc.text(receiptContent, 10, 10);
            doc.save('resit.pdf');
        }

        // Fungsi untuk auto-nombor resit
        function generateReceiptNumber() {
            const now = new Date();
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const seconds = String(now.getSeconds()).padStart(2, '0');
            return `RESIT-${year}${month}${day}-${hours}${minutes}${seconds}`;
        }
    </script>
</body>
</html>